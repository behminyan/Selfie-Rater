{"version":3,"sources":["webpack:///./src/css/main.scss","webpack:///./src/js/listeners.js","webpack:///./src/js/index.js"],"names":[],"mappings":"iCAAA,uBCAA,iBAAM,GAAa,EACnB,SAAM,EAAQ,EACd,UAAM,EAAS,EAAE,WACjB,GAAM,EAAQ,EACd,aAAM,EAAQ,EAAE,YAChB,GAAM,EAAO,EACb,SAAM,EAAW,EAEjB,aAAI,EAAU,EAAO,WAAW,MAEhC,EAAW,GAAG,QAAS,UAErB,GAAM,SACN,oBAAW,UACT,GAAM,YACP,QAFD,EAKA,OAAW,SACX,cAAK,SACL,YAAS,SAGT,kBAAQ,IAAI,EAAM,MAAO,EAAM,OAAQ,EAAO,MAAO,EACrD,UAAM,KAAK,OAAQ,EAAO,UAC3B,aAED,GACA,EAAK,GAAG,QAAS,UACf,GAAQ,UAAU,EAAG,EAAG,EAAO,MAAO,EAGtC,UAAW,YACX,cAAK,YACL,YAAS,YACV,SAQA,4CC3CD,gBACA,EAEA,QACA,EAEA,QACA,EAGM,QAGN,EAAS,cAAc,UAAU,MAAiC,eAChE,IAAI,GACJ,KAAI,EAAc,KAElB,oBACE,QAAM,IAAI,OAGZ,mFAEA,QAAY,QAAiB,WAC3B,GAAU,EAAQ,OAAO,EAAS,WAAiC,aAAQ,EAAK,kBAAmB,EAAK,iBAAkB,EAAK,cAAe,EAC/I,qBAED,QAAK,KAAK,QACR,CACA,OACA,SACA,QAEH,UApBD,EAsBA,GAAM,GAAc,GAAI,GAAS,cAAc,QAC/C,EAAY,gBAAgB,GAC5B,EAAY,YAAY,GACxB,EAAY,gBAAgB,KAE5B,GAAM,GAAS,SAAS,eACxB,QAAM,EAAU,EAAO,WAEvB,MAAI,EAAe,EAEnB,EAAY,GAAG,QAAkB,WAE/B,GAAQ,UAAU,EAAG,EAAG,EAAO,MAAO,EAGtC,QACE,CADE,KAAM,KAAK,OACT,KAEF,uBAAS,eAAe,aAAa,UAKvC,SAAe,KAEf,QAAM,KAAK,QAAS,WAElB,GAAE,KACA,CACA,IArDF,kCAsDE,YAAM,KAAK,UACT,QAAQ,MAAM,KAAK,EACnB,cAAO,EACP,aAAQ,EAEV,qBACA,4BAAU,SACT,KAAM,WAEP,UAAS,eAAe,aAAa,UAAY,EAAS,OAAO,QAClE,EAGD,KACA,YApEkB,YAoEV,WAAW,EAAK,EAAG,EAAK,EAAG,EAAK,MAAO,EAC/C,UAAQ,KACR,mBAAQ,UACR,SAAQ,SAAS,MAAQ,EAAK,EAAI,KAAM,EAAK,EAAI,EAAK,MAAQ,EAAG,EAAK,EACtE,MAAQ,SAAS,MAAQ,EAAK,EAAI,KAAM,EAAK,EAAI,EAAK,MAAQ,EAAG,EAAK,EACvE,GAEJ,GAzCD,GA2CA,EAAS,MAAkB,aAAa,CAAS","file":"main.0aa9dafa.js","sourcesContent":["// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/css/main.scss\n// module id = DG0N\n// module chunks = 2","const snapButton = $('.snap');\r\nconst flash = $('.flash');\r\nconst canvas = $('.canvas')[0]; // the actual canvas DOM element\r\nconst dlink = $('.download');\r\nconst video = $('#myVideo')[0];\r\nconst redo = $('.redo');\r\nconst download = $('.download');\r\n\r\nvar context = canvas.getContext('2d');\r\n\r\nsnapButton.on('click', () => {\r\n  // flash animation\r\n  flash.addClass('click');\r\n  setTimeout(() => {\r\n    flash.removeClass('click');\r\n  }, 200);\r\n\r\n  // animation\r\n  snapButton.addClass('inactive');\r\n  redo.addClass('active');\r\n  download.addClass('active');\r\n\r\n  // download photo\r\n  console.log(video.width, video.height, canvas.width, canvas.height);\r\n  dlink.attr('href', canvas.toDataURL('image/png'));\r\n});\r\n\r\n// redo button\r\nredo.on('click', () => {\r\n  context.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n  // animation\r\n  snapButton.removeClass('inactive');\r\n  redo.removeClass('active');\r\n  download.removeClass('active');\r\n});\r\n\r\nfunction videoLoop () {\r\n  const dX = 110;\r\n  const dY = 80;\r\n  context.drawImage(video, dX, 0, canvas.width + dX - 20, canvas.height + dY, 0, 0, canvas.width, canvas.height);\r\n  context.drawImage(video, dX, 0, canvas.width + dX - 20, canvas.height + dY, 0, 0, canvas.width, canvas.height);  \r\n  setTimeout(videoLoop, 1000 / 24);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/listeners.js","// import stylesheets\r\nrequire('../css/main.scss');\r\n\r\n// button listeners\r\nrequire('./listeners');\r\n\r\n/* global tracking */\r\nrequire('tracking/build/data/face-min');\r\n\r\nconst RATING_EXPIRY = 3000;\r\nconst BACKEND_URL = 'http://18.220.71.37/rateme';\r\nconst DETECTION_COLOR = '#a64ceb';\r\n\r\ntracking.ObjectTracker.prototype.track = function (pixels, width, height) {\r\n  var self = this;\r\n  var classifiers = this.getClassifiers();\r\n\r\n  if (!classifiers) {\r\n    throw new Error('Object classifier not specified, try `new tracking.ObjectTracker(\"face\")`.');\r\n  }\r\n\r\n  var results = [];\r\n\r\n  classifiers.forEach(function(classifier) {\r\n    results = results.concat(tracking.ViolaJones.detect(pixels, width, height, self.getInitialScale(), self.getScaleFactor(), self.getStepSize(), self.getEdgesDensity(), classifier));\r\n  });\r\n\r\n  this.emit('track', {\r\n    data: results,\r\n    pixels: pixels,\r\n    width: width,\r\n    height: height,\r\n  });\r\n};\r\n\r\nconst faceTracker = new tracking.ObjectTracker('face');\r\nfaceTracker.setInitialScale(4);\r\nfaceTracker.setStepSize(2);\r\nfaceTracker.setEdgesDensity(0.1);\r\n\r\nconst canvas = document.getElementById('face');\r\nconst context = canvas.getContext('2d');\r\n\r\nlet last_face_ts = 0;\r\n\r\nfaceTracker.on('track', function(event) {\r\n  // Clear rectangles\r\n  context.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n  // No face(s) found\r\n  if (event.data.length === 0) {\r\n    if (Date.now() - last_face_ts > RATING_EXPIRY) {\r\n      // Reset rating\r\n      document.getElementById('ratingNum').innerHTML = '--';\r\n    }\r\n  }\r\n  // Face(s) found\r\n  else {\r\n    last_face_ts = Date.now();\r\n\r\n    event.data.forEach((rect) => {\r\n      // Send for scoring\r\n      $.ajax({\r\n        url: BACKEND_URL,\r\n        type: 'POST',\r\n        data: JSON.stringify({\r\n          pixels: Array.from(event.pixels),\r\n          width: event.width,\r\n          height: event.height,\r\n        }),\r\n        contentType: 'application/json',\r\n        dataType: 'json',\r\n      }).done((response) => {\r\n        // Update UI\r\n        document.getElementById('ratingNum').innerHTML = response.rating.toFixed(2);\r\n      });\r\n\r\n      // Draw face detection\r\n      context.strokeStyle = DETECTION_COLOR;\r\n      context.strokeRect(rect.x, rect.y, rect.width, rect.height);\r\n      context.font = '11px Helvetica';\r\n      context.fillStyle = '#fff';\r\n      context.fillText('x: ' + rect.x + 'px', rect.x + rect.width + 5, rect.y + 11);\r\n      context.fillText('y: ' + rect.y + 'px', rect.x + rect.width + 5, rect.y + 22);\r\n    });\r\n  }\r\n});\r\n\r\ntracking.track('#myVideo', faceTracker, {camera: true});\n\n\n// WEBPACK FOOTER //\n// ./src/js/index.js"],"sourceRoot":""}